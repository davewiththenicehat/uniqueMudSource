<VirtualHost *:80>
  # Always redirect to https/443
  ServerName mud.techknowledge.repair
  Redirect / https://mud.techknowledge.repair
</VirtualHost>

<VirtualHost *:443>
  ServerName mud.techknowledge.repair
  
  SSLEngine On
#ProxyRequests Off
  SSLProxyEngine on
ProxyRequests Off
ProxyPreserveHost On

  
  # Location of certificate and key
  SSLCertificateFile /etc/apache2/ssl/wild/STAR_techknowledge_repair.crt
  SSLCertificateKeyFile /etc/apache2/ssl/wild/STAR_techknowledge_repair.key
  SSLCertificateChainFile /etc/apache2/ssl/wild/STAR_techknowledge_repair.ca-bundle 
  # Use a tool https://www.ssllabs.com/ssltest/ to scan your set after setting up.
  SSLProtocol TLSv1.2
  SSLCipherSuite HIGH:!eNULL:!NULL:!aNULL
  
  # Proxy all websocket traffic to port 4002 in Evennia
  ProxyPass /ws ws://127.0.0.1:4002/
  ProxyPassReverse /ws ws://127.0.0.1:4002/
  
  # Proxy all HTTP traffic to port 4001 in Evennia
  ProxyPass / http://127.0.0.1:4001/
  ProxyPassReverse / http://127.0.0.1:4001/
  
  # Configure separate logging for this Evennia proxy
  ErrorLog /var/log/apache2/evennia_error.log
  CustomLog /var/log/apache2/evennia_access.log combined
</VirtualHost>
